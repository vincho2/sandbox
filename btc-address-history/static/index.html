<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="initial-scale=1, width=device-width" />

        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

        <link rel="icon" type="image/x-icon" href="/img/favicon.ico" />
        <link rel="stylesheet" href="/styles.css"/>
        <script type="module" defer src="/js/main.js"></script>

        <title>Get BTC address history</title>

    </head>

    <body>
        <!-- Navbar with search -->
        <nav id="main-navbar" class="navbar-expand-md navbar-light bg-white shadow-sm fixed-top p-3">
            <div class="container-fluid">
                <div class="d-flex w-100">
                    <a class="navbar-brand me-3" href="/">
                        <img src="img/favicon.ico" alt="Logo" width="30" height="30" class="d-inline-block align-text-top">
                    </a>

                    <form class="d-flex mb-3 flex-grow-1" action="/" method="get">
                        <input autocomplete="off" autofocus class="form-control me-3" name="address" placeholder="Enter BTC address" type="text">
                        <button class="btn btn-primary" type="submit">Search</button>
                    </form>

                </div>
                <div id="loading-indicator" class="ms-2 d-none d-flex align-items-center">
                    <div class="spinner-border spinner-border-sm text-primary me-2" role="status"></div>
                    <span class="small text-muted">Loading…</span>
                </div>


                <div id="error-display" class="text-danger small w-100"></div>
                <div id="address-info" class="w-100"></div>
            </div>
            
            
        </nav>

        <!-- Main content -->
        <main class="container" id="main-content" hidden>
            <!-- Transaction history block -->
            <section id="tx-history-list" class="card shadow-lg border-0 rounded-4 p-4 bg-white"></section>
                
            <!-- Sentinel for infinite scroll -->
            <section id="page-end"></section>
        </main>

        <!-- -------------------------------------------------------------------------------------->
        <!-- Templates (not visible, used by JS) -->
        <!-- -------------------------------------------------------------------------------------->

            
        <!-- TEMPLATE - Address info block -------------------------------------------------------->
        <template id="address-info-template">
            <!-- Address info block template  -->       
            <section class="card shadow-lg border-0 rounded-4 p-4 bg-white">

                <!-- Line 1: Adress -->
                <h5 class="address-id">
                    <span>Address:</span>
                    <span class="address-id-value" data-address-id></span>
                </h5>

                <!-- Line 2: Confirmed balance -->
                <div class="address-row">
                    <div class="address-item">
                        <span class="label">Address balance (confirmed transactions):</span>
                        <span class="value" data-conf-balance-sats></span>
                        <span class="text-muted" data-conf-balance-btc></span>
                    </div>
                    <div class="address-item">
                        <span class="label">Number of confirmed transactions:</span>
                        <span class="value" data-conf-tx-count></span>
                    </div>
                </div>

                <!-- Line 3 : Pending transaction in mempool -->
                <div id="mempool-info" hidden>
                    <div class="address-row">
                        <div class="address-item">
                            <span class="label">Pending mempool in/out flow:</span>
                            <span class="value" data-pool-io-flow-sats></span>
                            <span class="text-muted" data-pool-io-flow-btc></span>
                        </div>
                        <div class="address-item">
                            <span class="label">Number of transactions pending in the mempool:</span>
                            <span class="value" data-pool-tx-count></span>
                        </div>
                    </div>
                    <div class="address-row">
                        <div class="address-item">
                            <span class="label">Balance including mempool transactions:</span>
                            <span class="value" data-total-balance-sats></span>
                            <span class="text-muted" data-total-balance-btc></span>
                        </div>
                    </div>
                </div>
                <div id="mempool-no-info" hidden>
                    <p class="label">No pending transaction in the mempool</p>
                </div>
            </section>
        </template>


        <!-- TEMPLATE - Transaction block TO DO --------------------------------------------------------->
        <template id="tx-template">
            <div class="tx-card d-flex align-items-center py-2 border-bottom">

                <!-- ICON -->
                <div class="me-3">
                <i class="bi fs-3" data-tx-icon></i>
                </div>

                <!-- CENTER -->
                <div class="flex-grow-1">
                <div class="fw-semibold">
                    Transaction #<span data-tx-nb></span>
                </div>

                <div class="text-muted small">
                    <span data-block-datetime></span>
                    <span data-tx-status></span>
                </div>
                </div>

                <!-- AMOUNT and BALANCE -->
                <div class="text-end">
                    <div class="fw-bold fs-5">
                        <span data-tx-amount-sats></span>
                        <span class="text-muted small" data-tx-amount-btc></span>

                    </div>
                    <div class="text-muted small">
                        New Balance: <span data-new-balance-sats></span>
                        <span data-new-balance-btc></span>
                    </div>
                </div>
            </div>
        </template>



        <!-- TEMPLATE - Error block --------------------------------------------------------------->
        <template id="error-display-template">
            <p data-error-generic></p>
            <p class="text-muted" data-error-message></p>
        </template>

    </body>

</html>

